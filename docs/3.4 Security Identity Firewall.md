# Security - Identity Firewall 

## Introduction

In this section, we will go through how to configure and test the NSX
Identity Firewall (IDFW) capabilities for micro-segmentation. Identity Firewall with NSX-T Data Center, just like Distributed Firewall, does not require Overlay networking and can be done on a VLAN-backed
Segment. The following example will use Overlay networking but note this
is not a requirement.

NSX-T IDFW works for both single user and multi-user (Microsoft Remote Desktop Server Host) use cases. 

# Security - Identity Firewall Requirements

The following items are required before the Identity Firewalling functionality can be utilized. 

1. [NSX Requirements](/docs/1-Requirements.md)
2. [NSX Installation](/docs/2-Installation.md)
3. [Microsoft Active Directory supported version](https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-9CD3FC21-9ED4-4FB3-9E19-67A7C4D1F53E.html#GUID-9CD3FC21-9ED4-4FB3-9E19-67A7C4D1F53E)
    - Active Directory with 2016 Functional Level is used in this example
4.  LDAP User account with read access to the Active Directory
5.  Base DN of the domain
    - Domain = Corp.local | Base DN = dc=corp,dc=local
4.  Two (2) User accounts in Active Directory that can be used to test IDFW Security Policy configurations
    - HR User - Corp\Bob 
    - Engineering User - Corp\Alice
6.  [Virtual Machine with supported Windows Operating System](https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-9CD3FC21-9ED4-4FB3-9E19-67A7C4D1F53E.html#GUID-9CD3FC21-9ED4-4FB3-9E19-67A7C4D1F53E)
    - If using Windows Server 2012R2 or 2016 for RDSH, [RDSH role needs to be installed and properly licensed](https://support.microsoft.com/en-us/help/2833839/guidelines-for-installing-the-remote-desktop-session-host-role-service)
    - Windows Server 2016 with Remote Desktop Services Host Role is used in this example
7.  [VMware Tools version supported](https://www.vmware.com/resources/compatibility/sim/interop_matrix.php#interop&175=&139=)
    - VMware Tools requires: (Easier to do a 'Complete' installation of VMware Tools, which includes the below drivers)
        - VMCI Driver Installed
        - NSX File Introspection Driver Installed
        - NSX Network Introspection Driver Installed
8.  SSH Client to check IDFW in the ESXi data plane
    - Putty will be used in this example
9.  PowerShell with Active Directory plugin to check Active Directory Group SID
10.  Destination server to test connectivity allow and drop with IDFW based on user
    - Access to a web page hosted on a Web server will be used in this example

# Security - Identity Firewall Configuration

## Add Active Directory to NSX-T Manager

1.  Log into the NSX-T Manager and navigate to **System > Identity Firewall AD > Active Directory** and click **ADD ACTIVE DIRECTORY**

![Add Active Directory](/docs/assets/Graphics/IDFW/3.4.1.step1.png)








